!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators"),require("@angular/animations"),require("@angular/forms"),require("@angular/platform-browser/animations")):"function"==typeof define&&define.amd?define("@ng-poppy/popover",["exports","@angular/core","@angular/common","rxjs","rxjs/operators","@angular/animations","@angular/forms","@angular/platform-browser/animations"],t):t(((e=e||self)["ng-poppy"]=e["ng-poppy"]||{},e["ng-poppy"].popover={}),e.ng.core,e.ng.common,e.rxjs,e.rxjs.operators,e.ng.animations,e.ng.forms,e.ng.platformBrowser.animations)}(this,(function(e,t,n,i,o,r,s,p){"use strict";var c=new t.InjectionToken("popover-config"),l=function(e){this.type=e.type,this.triggeredBy=e.triggeredBy||"click",this.closeOnScroll=void 0===e.closeOnScroll||e.closeOnScroll,this.delayClose=Number.isInteger(e.delayClose)?e.delayClose:null,this.closeOnTriggerAgain=!!e.closeOnTriggerAgain,this.hideOnScroll=!!e.hideOnScroll},a=r.trigger("fadeIn",[r.state("open",r.style({transform:"translateY(0px)",opacity:1})),r.state("close",r.style({transform:"translateY(-6px)",opacity:.5})),r.transition("close => open",[r.animate("0.15s")])]),u=10,h="px",f=function(){function e(e){this.initHostElementWidth=0,this.popover=e,this.hostElement=e.element,this.config=e.popoverConfig,this.type=this.config.type,this.position=this.config.position}return e.prototype.init=function(){var e=this,t=this.config.bounds;if(this.hostElement.nativeElement.style.zIndex=1e4,this.setPositionStyle("left",0),this.setPositionStyle("top",+t.top+t.height+u),this.isContextType||this.isSubmenuType||(this.hostElement.nativeElement.style.minWidth=t.width+"px"),this.isContextType&&(this.setPositionStyle("top",+t.top),this.hostElement.nativeElement.style.minWidth=0),this.isSubmenuType){var n=this.config.submenuTriggeredItem.element.nativeElement.getBoundingClientRect();this.hostElement.nativeElement.style.minWidth=0,this.setPositionStyle("top",n.top)}if(this.canAssignPadding){var i=this.isTooltip?"8px 12px":"15px 25px";this.popover.popoverWrapperEl.nativeElement.style.padding=i}this.hostElement.nativeElement.style.visibility="hidden",setTimeout((function(){e.initHostElementWidth=e.hostElement.nativeElement.offsetWidth+1,e.hostElement.nativeElement.style.minWidth=e.initHostElementWidth+"px"}))},e.prototype.update=function(){this.setLeftPosition(),this.setTopPosition(),this.setWidth(),this.hostElement.nativeElement.style.visibility="visible"},e.prototype.setTopPosition=function(){var e=window.innerHeight,t=this.hostElement.nativeElement.getBoundingClientRect().height,n=this.config.triggerElement.nativeElement.getBoundingClientRect();if(this.config.triggerDirective){var i="context"===this.config.type?this.config.bounds.top:n.top+n.height;if(t>=e-i-20)if("context"===this.config.type)this.setPositionStyle("top",+this.config.bounds.top-t+u);else if(n.top-t-u>0)switch(this.position){case"bottom":this.setPositionStyle("top",n.top-t-u);break;case"top":this.setPositionStyle("top",n.top-t-u)}else this.hostElement.nativeElement.style.height=e-i-20+h;else if("context"===this.config.type)this.setPositionStyle("top",+this.config.bounds.top+u);else switch(this.position){case"bottom":this.setPositionStyle("top",n.top+n.height+u);break;case"top":this.setPositionStyle("top",n.top-t-u);break;case"left":case"right":this.setPositionStyle("top",n.top-(t/2-n.height/2))}}if(!this.config.triggerDirective){var o=this.config.submenuTriggeredItem.element.nativeElement.getBoundingClientRect().top;if(t>=e-o-20){var r=t-(e-o);this.setPositionStyle("top",o-r-20)}else this.setPositionStyle("top",o)}},e.prototype.setLeftPosition=function(){var e=window.innerWidth,t=this.hostElement.nativeElement.getBoundingClientRect().width,n=this.config.triggerElement.nativeElement.getBoundingClientRect();if(this.isContextType)+this.config.bounds.left>=e/2?this.setPositionStyle("left",+this.config.bounds.left-t):this.setPositionStyle("left",this.defaultLeftPosition);else if(this.config.triggerDirective){switch(this.position){case"bottom":case"top":this.setPositionStyle("left",n.left);break;case"left":this.setPositionStyle("left",n.left-t-10);break;case"right":this.setPositionStyle("left",n.left+n.width+10)}var i=this.hostElement.nativeElement.getBoundingClientRect();i.right>e-20&&this.setPositionStyle("left",i.left-(i.right-e+20)),i.left<0&&this.setPositionStyle("left",15)}else{var o=this.config.submenuTriggeredItem.element.nativeElement.getBoundingClientRect();t>e-o.right?this.setPositionStyle("left",o.left-this.initHostElementWidth):this.setPositionStyle("left",o.right)}},e.prototype.setWidth=function(){this.config.triggerElement.nativeElement.getBoundingClientRect();if(!this.isContextType&&!this.isSubmenuType){var e=window.innerWidth,t=this.hostElement.nativeElement.getBoundingClientRect();this.hostElement.nativeElement.style.minWidth=this.initHostElementWidth+h,this.isMenuType||(t.width>e||this.initHostElementWidth>e-30)&&(this.hostElement.nativeElement.style.width=e-30+h,this.hostElement.nativeElement.style.minWidth=e-30+h,this.setPositionStyle("left",15))}},e.prototype.setPositionStyle=function(e,t){this.hostElement.nativeElement.style[e]=t+h},Object.defineProperty(e.prototype,"defaultLeftPosition",{get:function(){return this.config.bounds.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canAssignPadding",{get:function(){return!this.isContextType&&!this.isMenuType&&!this.isSubmenuType||this.isSubmenuType&&!!this.config.content},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isContextType",{get:function(){return"context"===this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMenuType",{get:function(){return"menu"===this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSubmenuType",{get:function(){return"submenu"===this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTooltip",{get:function(){return"tooltip"===this.type},enumerable:!1,configurable:!0}),e}(),d=function(){function e(e){this.element=e,this.selected=!1,this.hidden=!1,this.clicked=new t.EventEmitter}return Object.defineProperty(e.prototype,"selectedClass",{get:function(){return this.selected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hiddenClass",{get:function(){return this.hidden},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.clicked$=i.fromEvent(this.element.nativeElement,"click").pipe(o.tap((function(){e.clicked.emit()}))),this.hovered$=i.fromEvent(this.element.nativeElement,"mousemove")},e.prototype.ngAfterViewInit=function(){this.element.nativeElement.classList.add("popover-menu-item")},e}();function v(e,n){1&e&&t.ɵɵprojection(0)}d.ɵfac=function(e){return new(e||d)(t.ɵɵdirectiveInject(t.ElementRef))},d.ɵdir=t.ɵɵdefineDirective({type:d,selectors:[["","poppy-menu-item",""]],hostVars:4,hostBindings:function(e,n){2&e&&t.ɵɵclassProp("popover-menu-item--selected",n.selectedClass)("popover-menu-item--hidden",n.hiddenClass)},inputs:{submenu:"submenu",selected:"selected",hidden:"hidden"},outputs:{clicked:"clicked"}});var m=function(){};m.ɵfac=function(e){return new(e||m)},m.ɵcmp=t.ɵɵdefineComponent({type:m,selectors:[["poppy-menu"]],contentQueries:function(e,n,i){var o;(1&e&&t.ɵɵcontentQuery(i,d,!1),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.menuItems=o))},viewQuery:function(e,n){var i;(1&e&&t.ɵɵviewQuery(t.TemplateRef,!0),2&e)&&(t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.templateRef=i.first))},exportAs:["poppyMenu"],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,n){1&e&&(t.ɵɵprojectionDef(),t.ɵɵtemplate(0,v,1,0,"ng-template"))},encapsulation:2,changeDetection:0});var y=function(e,t,n,i,o,r){this.popoverRef=e,this.parentPopoverRef=t,this.superParentPopoverRef=n,this.directiveRef=i,this.type=o,this.deepLevel=r,this.isMenuParent="menu"===o,this.isSubmenu="submenu"===o,this.isSuperparent=this.popoverRef===this.superParentPopoverRef},g=function(e){void 0===e&&(e={}),this.delayClose=Number.isInteger(e.delayClose)?e.delayClose:null,this.overlay=!!e.overlay},b=new t.InjectionToken("layer-token"),C=["container"],E=function(){function e(e){this.config=e}return Object.defineProperty(e.prototype,"overlay",{get:function(){return this.config.overlay},enumerable:!1,configurable:!0}),e}();E.ɵfac=function(e){return new(e||E)(t.ɵɵdirectiveInject(b))},E.ɵcmp=t.ɵɵdefineComponent({type:E,selectors:[["poppy-layer"]],viewQuery:function(e,n){var i;(1&e&&t.ɵɵviewQuery(C,!0,t.ViewContainerRef),2&e)&&(t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.container=i.first))},hostVars:2,hostBindings:function(e,n){2&e&&t.ɵɵclassProp("poppy-layer--overlay",n.overlay)},decls:2,vars:0,consts:[["container",""]],template:function(e,n){1&e&&t.ɵɵelementContainer(0,null,0)},styles:["poppy-layer{bottom:0;display:block;left:0;position:fixed;right:0;top:0;visibility:hidden;z-index:10000}.poppy-layer--overlay{background:rgba(0,0,0,.42);overflow-y:auto;visibility:visible}"],encapsulation:2});var O=function(){function e(e,t){this.componentFactoryResolver=e,this.appRef=t,this.activeLayers=[]}return e.prototype.appendToBody=function(e,n,i){var o=this.componentFactoryResolver.resolveComponentFactory(E).create(t.Injector.create([{provide:b,useValue:n}]));o.changeDetectorRef.detectChanges();var r=this.componentFactoryResolver.resolveComponentFactory(e),s=o.instance.container.createComponent(r,null,i);this.activeLayers.push({ref:o,appendComponentRef:s,options:n}),this.appRef.attachView(o.hostView);var p=o.hostView.rootNodes[0];return document.body.appendChild(p),s},e.prototype.removeFromBody=function(e){var t=this;this.activeLayers.filter((function(t){return t.appendComponentRef===e})).forEach((function(e){var n=e.options.delayClose;null!==n?setTimeout((function(){t.removeLayer(e)}),n):t.removeLayer(e)})),this.activeLayers=this.activeLayers.filter((function(t){return t.appendComponentRef!==e}))},e.prototype.removeLayer=function(e){this.appRef.detachView(e.ref.hostView),e.ref.changeDetectorRef.detectChanges(),e.ref.destroy()},e}();O.ɵfac=function(e){return new(e||O)(t.ɵɵinject(t.ComponentFactoryResolver),t.ɵɵinject(t.ApplicationRef))},O.ɵprov=t.ɵɵdefineInjectable({token:O,factory:O.ɵfac,providedIn:"root"});var R=function(){function e(e){this.ngZone=e,this.registeredEvents=[]}return e.prototype.register=function(e,t,n){var i,o=this;this.ngZone.runOutsideAngular((function(){var t=o.getEventObservable(e);i=t.subscribe((function(e){n(e)}))})),this.registeredEvents.push({popover:t,type:e,sub:i,callback:n})},e.prototype.unregister=function(e,t){this.registeredEvents.filter((function(t){return t.type===e})).forEach((function(e){e.popover===t&&e.sub.unsubscribe()})),this.registeredEvents=this.registeredEvents.filter((function(n){return n.type!==e||n.popover!==t}))},e.prototype.subscribe=function(e,t){var n=this.getEventObservable(e);this.registeredEvents.filter((function(n){var i;return n.type===e&&n.popover===t&&(null===(i=n.sub)||void 0===i?void 0:i.closed)})).forEach((function(e){e.sub=n.subscribe((function(t){return e.callback(t)}))}))},e.prototype.unsubscribe=function(e,t){this.registeredEvents.filter((function(n){return n.type===e&&n.popover===t})).forEach((function(e){e.sub.unsubscribe()}))},e.prototype.getEventObservable=function(e){switch(e){case"click-outside":return i.merge(i.fromEvent(document,"click"),i.fromEvent(document,"contextmenu")).pipe();case"capture-scroll":return i.fromEvent(document,"scroll").pipe(o.tap((function(){})));case"resize":return i.fromEvent(window,"resize").pipe(o.tap((function(){})))}},e}();R.ɵfac=function(e){return new(e||R)(t.ɵɵinject(t.NgZone))},R.ɵprov=t.ɵɵdefineInjectable({token:R,factory:R.ɵfac,providedIn:"root"});var x=function(){function e(e,t){this.layerService=e,this.eventsService=t,this.activePopovers=[]}return e.prototype.append=function(e,t,n,i){var o=this.activePopovers.find((function(e){return e.directiveRef===t}));return n.closeOnTriggerAgain&&o?(this.remove(o.popoverRef),o.popoverRef):this.appendToBody(e,t,n,i)},e.prototype.remove=function(e){var t=this.activePopovers.find((function(t){return t.popoverRef===e}));t&&(t.directiveRef&&(t.directiveRef.popoverComponentRef=null,t.directiveRef.afterClose.emit()),t.popoverRef.destroy(),this.layerService.removeFromBody(t.popoverRef),this.eventsService.unregister("click-outside",t),this.eventsService.unregister("capture-scroll",t),this.eventsService.unregister("resize",t),this.activePopovers=this.activePopovers.filter((function(t){return t.popoverRef!==e})))},e.prototype.removeByNativeElementRef=function(e){var t=this.activePopovers.find((function(t){return t.popoverRef.location.nativeElement===e}));t&&this.remove(t.popoverRef)},e.prototype.getActive=function(e){return this.activePopovers.find((function(t){return t.popoverRef===e}))},e.prototype.isPopoverSubmenuExits=function(e,t){var n=this.getActive(e);return!(!n||n&&!n.deepLevel)&&!!this.activePopovers.find((function(e){return e.parentPopoverRef===t&&e.deepLevel===n.deepLevel+1}))},e.prototype.removeAllNestedPopovers=function(e){var t=this,n=this.getActive(e);n&&this.activePopovers.filter((function(e){return e.deepLevel>n.deepLevel})).forEach((function(e){t.remove(e.popoverRef)}))},e.prototype.removeMenu=function(e){var t=this;this.activePopovers.filter((function(t){return t.parentPopoverRef===e||t.popoverRef===e})).forEach((function(e){t.remove(e.popoverRef)}))},e.prototype.subscribeToClickOutsideEventForParentPopover=function(e){var t=this,n=this.getActive(e);if(n){var i=this.activePopovers.find((function(e){return e.superParentPopoverRef===n.superParentPopoverRef&&e.deepLevel===n.deepLevel-1}));i&&setTimeout((function(){t.eventsService.subscribe("click-outside",i)}))}},e.prototype.appendToBody=function(e,t,n,i){var o=new g({delayClose:n.delayClose}),r=this.layerService.appendToBody(w,o,e),s=this.prepareSuperparentAndDeepLevel(r,i,t),p=s.superparent,c=s.deepLevel,l=new y(r,i,p,t,n.type,c);return r.instance.componentRef=r,r.instance.parentPopoverRef=r,r.changeDetectorRef.detectChanges(),this.activePopovers.push(l),l.directiveRef&&l.directiveRef.afterShow.emit(),this.canRegisterScrollCaptureEvent(l,n)&&this.registerScrollCaptureEvent(l,n),this.canRegisterResizeEvent(l,n)&&this.registerResizeEvent(l,n),r},e.prototype.prepareSuperparentAndDeepLevel=function(e,t,n){var i=0,o=null;if(n){var r=this.activePopovers.find((function(e){return e.popoverRef.instance.element.nativeElement.contains(n.hostElement.nativeElement)}));r?(o=r.superParentPopoverRef||r.popoverRef,i=r.deepLevel+1):(o=e,i=0)}else{var s=this.activePopovers.find((function(e){return e.popoverRef===t}));if(s){var p=this.activePopovers.filter((function(e){return e.superParentPopoverRef===s.superParentPopoverRef}));o=s.superParentPopoverRef,i=p[p.length-1].deepLevel+1}}return{deepLevel:i,superparent:o}},e.prototype.canRegisterScrollCaptureEvent=function(e,t){var n=t.triggeredBy,i=t.type,o=t.closeOnScroll;return e.directiveRef&&0===e.deepLevel&&"hover"!==n&&"submenu"!==i&&o},e.prototype.canRegisterResizeEvent=function(e,t){var n=t.triggeredBy,i=t.type;return e.directiveRef&&0===e.deepLevel&&"hover"!==n&&"submenu"!==i},e.prototype.registerResizeEvent=function(e,t){var n=this;this.eventsService.register("resize",e,(function(){"context"===t.type?n.hideGroup(e):n.updateGroupPosition(e)}))},e.prototype.registerScrollCaptureEvent=function(e,t){var n=this;this.eventsService.register("capture-scroll",e,(function(i){var o=e.directiveRef.hostElement.nativeElement===i.target||i.target.contains(e.directiveRef.hostElement.nativeElement);(o&&t.hideOnScroll||"context"===t.type)&&n.hideGroup(e),o&&!t.hideOnScroll&&"context"!==t.type&&n.updateGroupPosition(e)}))},e.prototype.hideGroup=function(e){var t=this;this.activePopovers.forEach((function(n){n.superParentPopoverRef===e.superParentPopoverRef&&t.remove(n.popoverRef)}))},e.prototype.updateGroupPosition=function(e){this.activePopovers.filter((function(t){return t.superParentPopoverRef===e.popoverRef})).forEach((function(e){e.popoverRef.instance.componentStyles&&e.popoverRef.instance.componentStyles.update()}))},e}();x.ɵfac=function(e){return new(e||x)(t.ɵɵinject(O),t.ɵɵinject(R))},x.ɵprov=t.ɵɵdefineInjectable({token:x,factory:x.ɵfac,providedIn:"root"});var S=["popoverWrapperEl"];function I(e,n){1&e&&t.ɵɵelementContainer(0)}function P(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,I,1,0,"ng-container",4),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",i.template)}}function k(e,n){if(1&e&&t.ɵɵtext(0),2&e){var i=t.ɵɵnextContext();t.ɵɵtextInterpolate1(" ",i.popoverConfig.content," ")}}var w=function(){function e(e,t,n,o,r,s,p){this.element=e,this.ngZone=t,this.componentFactoryResolver=n,this.popoverService=o,this.popoverEventsService=r,this.cdr=s,this.popoverConfig=p,this.animationState="close",this.animationEnd$=new i.Subject,this.menuItemsChanged=new i.Subject,this.destroy$=new i.Subject}return e.prototype.ngAfterViewInit=function(){var e,t=this;this.applyStyles(),this.popoverConfig.submenuTriggeredItem&&this.popoverConfig.submenuTriggeredItem.element.nativeElement.classList.add("popover-menu-item--focused"),this.popoverConfig.innerClass&&this.popoverWrapperEl.nativeElement.classList.add(this.popoverConfig.innerClass),this.listenForMouseEventOnHost(),this.canListenForClickOutside()&&this.ngZone.runOutsideAngular((function(){setTimeout((function(){t.listenForClickOutside()}))})),(null===(e=this.popoverConfig.menuRef)||void 0===e?void 0:e.menuItems)&&(this.listenForMenuItemTriggers(),this.popoverConfig.menuRef.menuItems.changes.pipe(o.takeUntil(this.destroy$)).subscribe((function(){t.menuItemsChanged.next(),t.listenForMenuItemTriggers(),t.popoverEventsService.unregister("click-outside",t.popoverService.getActive(t.componentRef)),setTimeout((function(){t.listenForClickOutside(),t.componentStyles.update()}),0)})))},e.prototype.ngOnDestroy=function(){this.popoverConfig.submenuTriggeredItem&&this.popoverConfig.submenuTriggeredItem.element.nativeElement.classList.remove("popover-menu-item--focused"),this.destroy$.next(),this.destroy$.complete()},Object.defineProperty(e.prototype,"template",{get:function(){var e;return this.popoverConfig.content instanceof t.TemplateRef&&this.popoverConfig.content||(null===(e=this.popoverConfig.menuRef)||void 0===e?void 0:e.templateRef)},enumerable:!1,configurable:!0}),e.prototype.animationEnd=function(e){"open"===e.toState&&this.animationEnd$.next()},e.prototype.applyStyles=function(){var e=this;this.componentStyles=new f(this),this.componentStyles.init(),setTimeout((function(){e.componentStyles.update(),e.animationState="open",e.detectChanges()}))},e.prototype.onClickMenuItem=function(e){!!e.submenu||this.popoverConfig.closeOnClickItem&&this.close()},e.prototype.onHoverMenuItem=function(e){var t=!this.popoverService.activePopovers.find((function(t){return t.popoverRef.instance.popoverConfig.submenuTriggeredItem===e})),n=!!e.submenu;t&&(this.popoverService.removeAllNestedPopovers(this.componentRef),this.detectChanges()),!this.popoverService.isPopoverSubmenuExits(this.componentRef,this.parentPopoverRef)&&n&&t&&this.createSubpopover(e)},e.prototype.listenForClickOutside=function(){var e=this,t=this.popoverService.getActive(this.componentRef);this.popoverEventsService.register("click-outside",t,(function(t){var n=t.target,i=n!==e.element.nativeElement&&!e.element.nativeElement.contains(n)&&n!==e.popoverConfig.triggerElement.nativeElement&&!e.popoverConfig.triggerElement.nativeElement.contains(n);"context"!==e.popoverConfig.type||n!==e.popoverConfig.triggerElement.nativeElement&&!e.popoverConfig.triggerElement.nativeElement.contains(n)||(i=!0),i&&e.close()}))},e.prototype.listenForMouseEventOnHost=function(){var e=this;i.fromEvent(this.element.nativeElement,"mouseenter").pipe(o.takeUntil(this.destroy$)).subscribe((function(){var t=e.popoverService.getActive(e.componentRef);(null==t?void 0:t.deepLevel)&&e.popoverService.activePopovers.forEach((function(n,i){i<=t.deepLevel?e.popoverEventsService.unsubscribe("click-outside",n):e.popoverEventsService.subscribe("click-outside",n)}))})),i.fromEvent(this.element.nativeElement,"mouseleave").pipe(o.takeUntil(this.destroy$)).subscribe((function(){e.popoverService.activePopovers.forEach((function(t){e.popoverEventsService.subscribe("click-outside",t)}))}))},e.prototype.listenForMenuItemTriggers=function(){var e=this;this.popoverConfig.menuRef.menuItems.forEach((function(t){t.clicked$.pipe(o.takeUntil(e.destroy$),o.takeUntil(e.menuItemsChanged)).subscribe((function(){e.onClickMenuItem(t)})),t.hovered$.pipe(o.takeUntil(e.destroy$),o.takeUntil(e.menuItemsChanged),o.debounceTime(0),o.skipUntil(e.animationEnd$)).subscribe((function(){e.onHoverMenuItem(t)}))}))},e.prototype.close=function(){this.isMenu()?(this.popoverService.subscribeToClickOutsideEventForParentPopover(this.componentRef),this.popoverService.removeMenu(this.parentPopoverRef)):this.popoverService.remove(this.componentRef)},e.prototype.createSubpopover=function(n){this.componentFactoryResolver.resolveComponentFactory(e);var i=n.element.nativeElement.getBoundingClientRect(),o="submenu",r=new l({type:o}),s={bounds:i,type:o,submenuTriggeredItem:n,triggerElement:this.popoverConfig.triggerElement,closeOnClickItem:this.popoverConfig.closeOnClickItem};(null==n?void 0:n.submenu)instanceof m&&(s.menuRef=n.submenu),(null==n?void 0:n.submenu)instanceof t.TemplateRef&&(s.content=n.submenu);var p=t.Injector.create([{provide:c,useValue:s}]);this.subMenuComponentRef=this.popoverService.append(p,null,r,this.parentPopoverRef),this.subMenuComponentRef.instance.componentRef=this.subMenuComponentRef,this.subMenuComponentRef.instance.parentPopoverRef=this.parentPopoverRef,this.subMenuComponentRef.hostView.detectChanges()},e.prototype.isMenu=function(){return"menu"===this.popoverConfig.type||"context"===this.popoverConfig.type||"submenu"===this.popoverConfig.type},e.prototype.canListenForClickOutside=function(){return this.popoverConfig.closeOnClickOutside&&("hover"!==this.popoverConfig.trigger||this.isMenu())},e.prototype.detectChanges=function(){this.cdr&&!this.cdr.destroyed&&this.cdr.detectChanges()},e}();w.ɵfac=function(e){return new(e||w)(t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.NgZone),t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(x),t.ɵɵdirectiveInject(R),t.ɵɵdirectiveInject(t.ChangeDetectorRef),t.ɵɵdirectiveInject(c))},w.ɵcmp=t.ɵɵdefineComponent({type:w,selectors:[["poppy-content"]],viewQuery:function(e,n){var i;(1&e&&t.ɵɵviewQuery(S,!0),2&e)&&(t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.popoverWrapperEl=i.first))},decls:5,vars:3,consts:[[1,"popover-content"],["popoverWrapperEl",""],[4,"ngIf","ngIfElse"],["textContent",""],[4,"ngTemplateOutlet"]],template:function(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",0,1),t.ɵɵlistener("@fadeIn.done",(function(e){return n.animationEnd(e)})),t.ɵɵtemplate(2,P,2,1,"ng-container",2),t.ɵɵtemplate(3,k,1,1,"ng-template",null,3,t.ɵɵtemplateRefExtractor),t.ɵɵelementEnd()),2&e){var i=t.ɵɵreference(4);t.ɵɵproperty("@fadeIn",n.animationState),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.template)("ngIfElse",i)}},directives:[n.NgIf,n.NgTemplateOutlet],styles:["poppy-content{position:absolute;visibility:visible}.popover-content{background-color:#fff;border-radius:2px;box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.133),0 .6px 1.8px 0 rgba(0,0,0,.11);box-sizing:border-box;max-height:400px;max-width:600px;overflow:auto}.popover-menu-list{margin:0;padding:0}.popover-menu-item{align-items:center;background-color:transparent;border:0;box-sizing:border-box;color:#323130;cursor:pointer;display:flex;justify-content:space-between;list-style:none;outline:0;padding:9px 12px;position:relative;text-align:left;width:100%}.popover-menu-item:disabled{opacity:.5}.popover-menu-item--focused,.popover-menu-item--selected,.popover-menu-item:hover{background-color:#edebe9}.popover-menu-item--hidden{display:none}"],encapsulation:2,data:{animation:[a]}});var T=function(){};T.ɵmod=t.ɵɵdefineNgModule({type:T}),T.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||T)},imports:[[n.CommonModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(T,{declarations:[E],imports:[n.CommonModule]});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function _(e,t){function n(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;function F(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}Object.create;var L=function(){function e(e,n,o,r){this.componentFactoryResolver=e,this.popoverService=n,this.hostElement=o,this.ngZone=r,this.trigger="click",this.delayClose=null,this.closeOnTriggerAgain=void 0,this.closeOnClickOutside=!0,this.hideOnScroll=!1,this.position="bottom",this.afterClose=new t.EventEmitter,this.afterShow=new t.EventEmitter,this.type="popover",this.destroy$=new i.Subject}return e.prototype.ngOnInit=function(){this.setOptions()},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.unsubscribe()},e.prototype.close=function(){this.popoverComponentRef&&this.remove(this.popoverComponentRef)},e.prototype.appendToLayer=function(e){var t=this.getPopoverComponentInjector(),n=Object.assign(Object.assign({},e),{delayClose:this.delayClose,closeOnTriggerAgain:this.closeOnTriggerAgain,hideOnScroll:this.hideOnScroll});this.popoverComponentRef=this.popoverService.append(t,this,n)},e.prototype.remove=function(e){var t=this;this.ngZone.run((function(){t.popoverService.remove(e)}))},e.prototype.setOptions=function(){void 0===this.closeOnTriggerAgain&&(this.closeOnTriggerAgain=!("tooltip"===this.type||"hover"===this.trigger||"context"===this.type))},e}();L.ɵfac=function(e){return new(e||L)(t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(x),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.NgZone))},L.ɵdir=t.ɵɵdefineDirective({type:L,inputs:{trigger:"trigger",delayClose:"delayClose",closeOnTriggerAgain:"closeOnTriggerAgain",closeOnClickOutside:"closeOnClickOutside",hideOnScroll:"hideOnScroll",innerClass:"innerClass",position:"position"},outputs:{afterClose:"afterClose",afterShow:"afterShow"}});var M=function(e){function n(t,n,i,o){var r=e.call(this,t,n,i,o)||this;return r.componentFactoryResolver=t,r.popoverService=n,r.hostElement=i,r.ngZone=o,r}return _(n,e),n.prototype.ngAfterViewInit=function(){var e=this;this.poppyPopover&&this.ngZone.runOutsideAngular((function(){"click"===e.trigger&&e.listenEventsForClickTrigger(),"hover"===e.trigger&&e.listenEventsForHoverTrigger()}))},n.prototype.open=function(){var e=this;this.canAppend()&&this.ngZone.run((function(){e.append()}))},n.prototype.getPopoverComponentInjector=function(){var e={bounds:this.hostElement.nativeElement.getBoundingClientRect(),type:this.type,trigger:this.trigger,triggerElement:this.hostElement,triggerDirective:this,content:this.poppyPopover,closeOnClickOutside:this.closeOnClickOutside,innerClass:this.innerClass,position:this.position};return t.Injector.create([{provide:c,useValue:e}])},n.prototype.canAppend=function(){return!this.popoverComponentRef||this.popoverComponentRef&&this.closeOnTriggerAgain},n.prototype.listenEventsForClickTrigger=function(){var e=this;i.fromEvent(this.hostElement.nativeElement,"click").pipe(o.takeUntil(this.destroy$)).subscribe((function(){e.open()}))},n.prototype.listenEventsForHoverTrigger=function(){var e=this,t=!1,n=!1,r=!1;i.merge(i.fromEvent(this.hostElement.nativeElement,"mouseenter"),i.fromEvent(this.hostElement.nativeElement,"click")).pipe(o.takeUntil(this.destroy$),o.tap((function(){i.fromEvent(e.hostElement.nativeElement,"mouseleave").pipe(o.takeUntil(e.destroy$),o.takeUntil(e.afterClose),o.debounceTime(200)).subscribe((function(){n=!1,r=!0,setTimeout((function(){r=!1}),200),t||e.remove(e.popoverComponentRef)}))})),o.switchMap((function(){return i.timer(300)}))).subscribe((function(){var s=document.body.contains(e.hostElement.nativeElement);t=!1,n=!0,s&&!r&&e.open(),setTimeout((function(){e.popoverComponentRef&&(i.fromEvent(e.popoverComponentRef.instance.element.nativeElement,"mouseenter").pipe(o.takeUntil(e.afterClose)).subscribe((function(){t=!0})),i.fromEvent(e.popoverComponentRef.instance.element.nativeElement,"mouseleave").pipe(o.takeUntil(e.afterClose)).subscribe((function(){t=!1,n||e.remove(e.popoverComponentRef)})))}),0)})),this.destroy$.pipe(o.take(1)).subscribe((function(){e.popoverComponentRef&&e.remove(e.popoverComponentRef)}))},n.prototype.append=function(){var e=new l({type:"popover",triggeredBy:this.trigger});this.appendToLayer(e)},n}(L);M.ɵfac=function(e){return new(e||M)(t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(x),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.NgZone))},M.ɵdir=t.ɵɵdefineDirective({type:M,selectors:[["","poppyPopover",""]],inputs:{poppyPopover:"poppyPopover"},exportAs:["poppyPopover"],features:[t.ɵɵInheritDefinitionFeature]});var A=function(e){this.template=e};A.ɵfac=function(e){return new(e||A)(t.ɵɵdirectiveInject(t.TemplateRef))},A.ɵdir=t.ɵɵdefineDirective({type:A,selectors:[["","poppy-chip",""]],exportAs:["poppyChip"]});var V=function(){function e(e){this.selectComponentRef=e}return e.prototype.onClick=function(e){this.remove(e)},e.prototype.remove=function(e){this.selectComponentRef&&this.selectComponentRef.closeChip(this.poppyChipRemove,e)},e}();V.ɵfac=function(e){return new(e||V)(t.ɵɵdirectiveInject(ne))},V.ɵdir=t.ɵɵdefineDirective({type:V,selectors:[["","poppyChipRemove",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(e){return n.onClick(e)}))},inputs:{poppyChipRemove:"poppyChipRemove"}});var D=function(e){function n(t,n,i,o){var r=e.call(this,t,n,i,o)||this;return r.componentFactoryResolver=t,r.popoverService=n,r.hostElement=i,r.ngZone=o,r.type="menu",r.closeOnClickItem=!0,r}return _(n,e),n.prototype.ngAfterViewInit=function(){var e=this;this.poppyMenu&&this.ngZone.runOutsideAngular((function(){"manual"!==e.trigger&&"menu"===e.type&&e.listenEventsForClickTrigger(),"context"===e.type&&e.listenEventsForContextTrigger()}))},n.prototype.open=function(){var e=this;this.canAppend()&&this.ngZone.run((function(){e.append()}))},n.prototype.updateContentPosition=function(){this.popoverComponentRef&&this.popoverComponentRef.instance.componentStyles.update()},n.prototype.getPopoverComponentInjector=function(){var e={bounds:this.getBounds(),type:this.type,triggerElement:this.hostElement,triggerDirective:this,closeOnClickOutside:this.closeOnClickOutside,closeOnClickItem:this.closeOnClickItem,menuRef:this.poppyMenu,innerClass:this.innerClass,position:this.position};return t.Injector.create([{provide:c,useValue:e}])},n.prototype.canAppend=function(){return!this.popoverComponentRef||this.popoverComponentRef&&"context"===this.type||this.popoverComponentRef&&this.closeOnTriggerAgain},n.prototype.listenEventsForClickTrigger=function(){var e=this;i.fromEvent(this.hostElement.nativeElement,"click").pipe(o.takeUntil(this.destroy$)).subscribe((function(){e.open()}))},n.prototype.listenEventsForContextTrigger=function(){var e=this;i.fromEvent(this.hostElement.nativeElement,"contextmenu").pipe(o.takeUntil(this.destroy$)).subscribe((function(t){t.preventDefault(),e.contextMenuPosition={top:t.clientY,left:t.clientX},e.open()}))},n.prototype.append=function(){var e=new l({type:this.type});this.appendToLayer(e)},n.prototype.getBounds=function(){return"context"===this.type?{top:this.contextMenuPosition.top,left:this.contextMenuPosition.left}:this.hostElement.nativeElement.getBoundingClientRect()},n}(L);D.ɵfac=function(e){return new(e||D)(t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(x),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.NgZone))},D.ɵdir=t.ɵɵdefineDirective({type:D,selectors:[["","poppyMenu",""]],inputs:{poppyMenu:"poppyMenu",type:"type",closeOnClickItem:"closeOnClickItem"},exportAs:["poppyMenu"],features:[t.ɵɵInheritDefinitionFeature]});var B=function(e){this.template=e};B.ɵfac=function(e){return new(e||B)(t.ɵɵdirectiveInject(t.TemplateRef))},B.ɵdir=t.ɵɵdefineDirective({type:B,selectors:[["","poppy-option",""]],exportAs:["poppyOption"]});var $=function(){function e(e,t){this.host=e,this.popoverService=t}return e.prototype.onClick=function(){this.remove()},e.prototype.remove=function(){var e=this;setTimeout((function(){var t=e.host.nativeElement.closest("poppy-content");e.popoverService.removeByNativeElementRef(t)}))},e}();$.ɵfac=function(e){return new(e||$)(t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(x))},$.ɵdir=t.ɵɵdefineDirective({type:$,selectors:[["","poppyRemoveOnClick",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(e){return n.onClick(e)}))}});var N=function(e){function t(t,n,i,o){var r=e.call(this,t,n,i,o)||this;return r.componentFactoryResolver=t,r.popoverService=n,r.hostElement=i,r.ngZone=o,r.trigger="hover",r.type="tooltip",r}return _(t,e),t.prototype.ngOnInit=function(){this.poppyPopover=this.poppyTooltip},t}(M);N.ɵfac=function(e){return new(e||N)(t.ɵɵdirectiveInject(t.ComponentFactoryResolver),t.ɵɵdirectiveInject(x),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(t.NgZone))},N.ɵdir=t.ɵɵdefineDirective({type:N,selectors:[["","poppyTooltip",""]],inputs:{poppyTooltip:"poppyTooltip"},features:[t.ɵɵInheritDefinitionFeature]});var W=["input"],z=function(e){return{$implicit:e}};function Q(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementContainer(1,16),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit,o=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o.chipTemplate.template)("ngTemplateOutletContext",t.ɵɵpureFunction1(2,z,i))}}function U(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",17),t.ɵɵelementStart(1,"div",18),t.ɵɵtext(2),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",19),t.ɵɵlistener("click",(function(e){t.ɵɵrestoreView(i);var n=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(2).closeChip(n,e)})),t.ɵɵtext(4," ✖ "),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var o=t.ɵɵnextContext().$implicit,r=t.ɵɵnextContext(2);t.ɵɵadvance(2),t.ɵɵtextInterpolate(r.getDisplayLabel(o))}}function Z(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",14),t.ɵɵtemplate(1,Q,2,4,"ng-container",7),t.ɵɵtemplate(2,U,5,1,"div",15),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.chipTemplate),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!i.chipTemplate)}}function q(e,n){if(1&e&&(t.ɵɵelementStart(0,"span",20),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.placeholder)}}function H(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",11),t.ɵɵtemplate(1,Z,3,2,"div",12),t.ɵɵtemplate(2,q,2,1,"span",13),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",i.displayedChips),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!i.selectedOptions.length)}}function G(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",21),t.ɵɵelementStart(1,"button",22),t.ɵɵlistener("click",(function(e){return t.ɵɵrestoreView(i),t.ɵɵnextContext().clear(e)})),t.ɵɵtext(2,"×"),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}function J(e,n){1&e&&t.ɵɵelement(0,"div",23)}function Y(e,n){1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",24),t.ɵɵtext(2," loader.. "),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd())}function K(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementContainer(1,16),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit,o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o.optionTemplate.template)("ngTemplateOutletContext",t.ɵɵpureFunction1(2,z,i))}}function X(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtext(1),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit,o=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",o.getDisplayLabel(i)," ")}}function ee(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"li",25),t.ɵɵlistener("clicked",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext().onClickItem(e)})),t.ɵɵtemplate(1,K,2,4,"ng-container",7),t.ɵɵtemplate(2,X,2,1,"ng-container",7),t.ɵɵelementEnd()}if(2&e){var o=n.$implicit,r=t.ɵɵnextContext();t.ɵɵproperty("hidden",o.hidden)("selected",o.selected),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",r.optionTemplate),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!r.optionTemplate)}}function te(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",26),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.notFoundText)}}var ne=function(){function e(e,n){this.cdr=e,this.controlContainer=n,this.options=[],this.bindLabel="label",this.multiselect=!1,this.clearable=!0,this.searchable=!0,this.placeholder="Wybierz..",this.notFoundText="Nie znaleziono wyników",this.changed=new t.EventEmitter,this.selectedOptions=[],this.displayedOptions=[],this.displayedChips=[],this.asyncLoading=!1,this.isMenuOpen=!1,this.destroy$=new i.Subject,this.propagateChange=function(e){}}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(e){e.options&&e.options.previousValue!==e.options.currentValue&&this.onOptionsChange(),e.value&&e.value.previousValue!==e.value.currentValue&&this.writeValue(this.value)},e.prototype.ngAfterViewInit=function(){var e=this;this.menuRef.afterClose.pipe(o.takeUntil(this.destroy$)).subscribe((function(){e.isMenuOpen=!1,e.multiselect||e.onCloseMenu(),e.cdr.detectChanges()})),this.menuRef.afterShow.pipe(o.takeUntil(this.destroy$)).subscribe((function(){e.isMenuOpen=!0,e.cdr.detectChanges()})),this.menuRef.afterClose.pipe(o.take(1)).subscribe((function(){})),this.async&&this.loadAsyncOptions(null,{firstLoad:!0}),this.searchable&&this.onInputKeyUp()},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},Object.defineProperty(e.prototype,"noItemsFound",{get:function(){return!this.displayedOptions.length||!!this.displayedOptions.every((function(e){return e.hidden}))},enumerable:!1,configurable:!0}),e.prototype.writeValue=function(e){var t=this;void 0!==e?this.multiselect?this.updateSelectedItemsForMultiSelection(e):this.updateSelectedItemsForSingleSelection(e):this.reset(),setTimeout((function(){t.cdr.detectChanges()}))},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.setDisabledState=function(e){},e.prototype.getDisplayLabel=function(e){return this.bindLabel?e[this.bindLabel]:""},e.prototype.onClickItem=function(e){var t=this;this.selectedOptions=[],this.displayedOptions.forEach((function(n,i){t.matchByValueOrReference(n,e)?(t.displayedOptions[i].selected=!t.multiselect||!n.selected,t.displayedOptions[i].hidden=!!t.multiselect&&!n.hidden):t.multiselect||(t.displayedOptions[i].selected=!1),t.displayedOptions[i].selected&&t.selectedOptions.push(t.options[i])})),this.multiselect&&this.updateDisplayedChips(),this.multiselect||(this.inputEl.nativeElement.value=this.bindLabel?this.selectedOptions[0][this.bindLabel]:""),this.emitChange(),this.cdr.detectChanges()},e.prototype.onChangeInput=function(e){var t=this,n=e.value;this.bindLabel&&(this.async?this.loadAsyncOptions(n):(this.displayedOptions.forEach((function(e,i){t.displayedOptions[i].hidden=!e[t.bindLabel].includes(n)})),this.cdr.detectChanges()))},e.prototype.clear=function(e){e.stopPropagation(),this.reset(),this.emitChange()},e.prototype.getDisplayValue=function(){return this.selectedOptions.length?this.multiselect?"":"object"==typeof this.selectedOptions[0]&&this.bindLabel?this.selectedOptions[0][this.bindLabel]:"":""},e.prototype.closeChip=function(e,t){var n=this;this.selectedOptions=[],this.displayedOptions.forEach((function(t,i){n.matchByValueOrReference(t,e)&&(n.displayedOptions[i].selected=!1,n.displayedOptions[i].hidden=!1),n.displayedOptions[i].selected&&n.selectedOptions.push(n.options[i])})),this.updateDisplayedChips(),this.emitChange(),t&&t.stopPropagation(),this.cdr.detectChanges()},e.prototype.onOptionsChange=function(){this.displayedOptions=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(F(arguments[t]));return e}(this.options).map((function(e){return Object.assign(Object.assign({},e),{selected:!1,hidden:!1})}))},e.prototype.onInputKeyUp=function(){var e=this;i.fromEvent(this.inputEl.nativeElement,"keyup").pipe(o.tap((function(){e.async&&(e.asyncLoading=!0)})),o.debounceTime(this.async?500:0),o.map((function(e){return e.target})),o.takeUntil(this.destroy$)).subscribe((function(t){e.onChangeInput(t)}))},e.prototype.reset=function(){var e=this;this.displayedOptions.forEach((function(t,n){e.displayedOptions[n].hidden=!1,e.displayedOptions[n].selected=!1})),this.selectedOptions=[],this.multiselect&&(this.displayedChips=[])},e.prototype.emitChange=function(){var e=this.getPropagateValue();this.propagateChange(e),this.changed.emit(e)},e.prototype.getPropagateValue=function(){var e=this;return this.selectedOptions.length?this.multiselect?this.bindValue?this.selectedOptions.map((function(t){return t[e.bindValue]})):this.selectedOptions:this.bindValue?this.selectedOptions[0][this.bindValue]:this.selectedOptions[0]:this.multiselect?[]:null},e.prototype.onCloseMenu=function(){var e=this;this.inputEl.nativeElement.value=this.selectedOptions.length?this.selectedOptions[0][this.bindLabel]:null,this.displayedOptions.forEach((function(t,n){e.displayedOptions[n].hidden=!1}))},e.prototype.loadAsyncOptions=function(e,t){var n=this;void 0===t&&(t={}),this.asyncLoading=!t.firstLoad,this.async(e).subscribe((function(e){n.options=e,n.onOptionsChange(),n.asyncLoading=!1,n.cdr.detectChanges()}))},e.prototype.updateSelectedItemsForMultiSelection=function(e){var t=this;if(!Array.isArray(e)){if(null!==e)throw Error("Initial value for multiselect must be an array!");e=[]}this.selectedOptions=[],this.displayedChips=[],this.options.forEach((function(n,i){!!e.find((function(e){return t.matchByValueOrReference(n,e)}))?(t.selectedOptions.push(n),t.displayedOptions[i].selected=!0,t.displayedOptions[i].hidden=!0):(t.displayedOptions[i].selected=!1,t.displayedOptions[i].hidden=!1)})),this.updateDisplayedChips()},e.prototype.updateSelectedItemsForSingleSelection=function(e){var t=this;this.options.forEach((function(n,i){t.matchByValueOrReference(n,e)?(t.selectedOptions=[n],t.displayedOptions[i].selected=!0):t.displayedOptions[i].selected=!1})),e||(this.selectedOptions=[])},e.prototype.updateDisplayedChips=function(){var e=this;this.displayedOptions.filter((function(e){return e.selected})).forEach((function(t){-1===e.displayedChips.findIndex((function(n){return e.matchByValueOrReference(n,t)}))&&e.displayedChips.push(t)})),this.displayedChips.forEach((function(t,n){e.displayedOptions.filter((function(e){return e.selected})).find((function(n){return e.matchByValueOrReference(t,n)}))||e.displayedChips.splice(n,1)})),this.menuRef&&setTimeout((function(){e.menuRef.updateContentPosition()}))},e.prototype.matchByValueOrReference=function(e,t){return this.bindValue?t&&void 0!==t[this.bindValue]?e[this.bindValue]==t[this.bindValue]:e[this.bindValue]==t:e===t},e}();ne.ɵfac=function(e){return new(e||ne)(t.ɵɵdirectiveInject(t.ChangeDetectorRef),t.ɵɵdirectiveInject(s.ControlContainer,13))},ne.ɵcmp=t.ɵɵdefineComponent({type:ne,selectors:[["poppy-select"]],contentQueries:function(e,n,i){var o;(1&e&&(t.ɵɵcontentQuery(i,A,!0),t.ɵɵcontentQuery(i,B,!0)),2&e)&&(t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.chipTemplate=o.first),t.ɵɵqueryRefresh(o=t.ɵɵloadQuery())&&(n.optionTemplate=o.first))},viewQuery:function(e,n){var i;(1&e&&(t.ɵɵviewQuery(W,!0),t.ɵɵviewQuery(D,!0)),2&e)&&(t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.inputEl=i.first),t.ɵɵqueryRefresh(i=t.ɵɵloadQuery())&&(n.menuRef=i.first))},inputs:{options:"options",async:"async",value:"value",bindLabel:"bindLabel",bindValue:"bindValue",multiselect:"multiselect",clearable:"clearable",searchable:"searchable",placeholder:"placeholder",notFoundText:"notFoundText"},outputs:{changed:"changed"},features:[t.ɵɵProvidersFeature([{provide:s.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return ne})),multi:!0},{provide:s.NG_VALIDATORS,useExisting:t.forwardRef((function(){return ne})),multi:!0}]),t.ɵɵNgOnChangesFeature],decls:12,vars:12,consts:[[1,"poppy-select",3,"poppyMenu","closeOnClickItem"],[1,"poppy-select__content"],["class","poppy-select__multiselect",4,"ngIf"],["type","text",3,"hidden","placeholder","value","readOnly"],["input",""],["class","poppy-select__clear",4,"ngIf"],["class","poppy-select__arrow",4,"ngIf"],[4,"ngIf"],["menu","poppyMenu"],["poppy-menu-item","",3,"hidden","selected","clicked",4,"ngFor","ngForOf"],["class","poppy__no-items",4,"ngIf"],[1,"poppy-select__multiselect"],["class","poppy-select__chip",4,"ngFor","ngForOf"],["class","poppy-select__placeholder",4,"ngIf"],[1,"poppy-select__chip"],["class","poppy-chip",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"poppy-chip"],[1,"poppy-chip__content"],[1,"poppy-chip__close",3,"click"],[1,"poppy-select__placeholder"],[1,"poppy-select__clear"],[1,"clear-btn",3,"click"],[1,"poppy-select__arrow"],[1,"poppy-select__loader"],["poppy-menu-item","",3,"hidden","selected","clicked"],[1,"poppy__no-items"]],template:function(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",0),t.ɵɵelementStart(1,"div",1),t.ɵɵtemplate(2,H,3,2,"div",2),t.ɵɵelement(3,"input",3,4),t.ɵɵtemplate(5,G,3,0,"div",5),t.ɵɵtemplate(6,J,1,0,"div",6),t.ɵɵtemplate(7,Y,3,0,"ng-container",7),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"poppy-menu",null,8),t.ɵɵtemplate(10,ee,3,4,"li",9),t.ɵɵtemplate(11,te,2,1,"div",10),t.ɵɵelementEnd()),2&e){var i=t.ɵɵreference(9);t.ɵɵproperty("poppyMenu",i)("closeOnClickItem",!n.multiselect),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.multiselect),t.ɵɵadvance(1),t.ɵɵproperty("hidden",n.multiselect)("placeholder",n.placeholder)("value",n.getDisplayValue())("readOnly",!n.searchable),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",n.clearable&&!n.multiselect&&!!n.getDisplayValue()),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!n.asyncLoading),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.asyncLoading),t.ɵɵadvance(3),t.ɵɵproperty("ngForOf",n.displayedOptions),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",n.noItemsFound)}},directives:[D,n.NgIf,m,n.NgForOf,n.NgTemplateOutlet,d],styles:[".poppy-select{-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;align-items:center;border:1px solid #acacac;border-radius:3px;box-sizing:border-box;cursor:pointer;display:flex;min-height:42px;user-select:none}.poppy-select__content{height:100%;min-height:18px;position:relative;width:100%}.poppy-select__content input{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;height:100%;outline:0;padding:0 2rem 0 .8rem;width:100%}.poppy-select__chips{height:100%;margin-bottom:-6px}.poppy-select__multiselect{align-items:center;border-radius:4px;box-sizing:border-box;display:flex;flex-wrap:wrap;height:100%;padding:0 .8rem;width:100%}.poppy-select__chip{display:inline-block;margin-bottom:4px;margin-right:6px;margin-top:4px}.poppy-select__arrow{color:#f6f6f6;position:absolute;right:8px;top:12px}.poppy-select__clear{color:#f6f6f6;position:absolute;right:4px;top:-2px}.poppy-chip{align-items:stretch;background-color:#edebe9;border-radius:16px;cursor:pointer;display:flex;font-size:.92em;height:26px;line-height:1;overflow:hidden}.poppy-chip__content{align-items:center;display:flex;font-size:inherit;line-height:1rem;margin-right:4px;padding:0 0 0 10px}.poppy-chip__close{align-items:center;background-color:#cfcfcf;border-radius:16px;display:flex;font-size:.86em;justify-content:center;padding-top:1px;width:26px}.poppy-chip__close:hover{background-color:#c2c2c2}.poppy__no-items{padding:14px 10px}.poppy-select__placeholder{color:#767676}.poppy-select__loader{position:absolute;right:15px;top:12px}"],encapsulation:2,changeDetection:0});var ie=function(){};ie.ɵmod=t.ɵɵdefineNgModule({type:ie}),ie.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||ie)},imports:[[n.CommonModule,p.BrowserAnimationsModule,T]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(ie,{declarations:[M,D,w,d,m,ne,A,V,$,B,N],imports:[n.CommonModule,p.BrowserAnimationsModule,T],exports:[M,D,d,m,ne,A,V,$,B,N]}),e.PopoverChipDirective=A,e.PopoverChipRemoveDirective=V,e.PopoverDirective=M,e.PopoverMenuComponent=m,e.PopoverMenuDirective=D,e.PopoverMenuItemDirective=d,e.PopoverModule=ie,e.PopoverOptionDirective=B,e.PopoverRemoveOnClickDirective=$,e.PopoverSelectComponent=ne,e.TooltipDirective=N,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng-poppy-popover.umd.min.js.map